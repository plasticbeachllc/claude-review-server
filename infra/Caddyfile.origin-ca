# Caddy config for Cloudflare Origin CA (custom domain setup).
#
# Used by: just setup-tls root@server origin.pem origin-key.pem
# See README → "Alternative: Custom domain with Origin CA"

{
    auto_https off
}

:443 {
    tls /etc/caddy/certs/origin.pem /etc/caddy/certs/origin-key.pem
    reverse_proxy 127.0.0.1:8080
    request_body {
        max_size 5MB
    }
    log {
        output stdout
        format json
    }
}

# Internal health checks only — not exposed externally (UFW blocks 8081)
:8081 {
    reverse_proxy /health 127.0.0.1:8080
}
